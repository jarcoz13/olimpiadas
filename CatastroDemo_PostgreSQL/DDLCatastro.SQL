--   --------------------------------------------------
--   Generated by Enterprise Architect Version 7.5.850
--   Created On : viernes, 08 julio, 2011 
--   DBMS       : Oracle 
--   --------------------------------------------------

--  Create Tables 
CREATE TABLE CAMUNICIPIO
(
	K_CODIGOPOSTAL   numeric(8) NOT NULL,    --  Codigo postal asignado por el DANE
	N_MUNICIPIO      varchar(30) NOT NULL,    --  Nombre del municipio. 
	Q_NROHABITANTES  numeric(8),    --  Es el número de Habitantes del Municipio. 
	I_ESCAPITAL      varchar(1) DEFAULT 'N' NOT NULL,    --  Indica si es capital del Departamento. S es Si y N es NO 
	O_DESCRIPCION    varchar(200)    --  Breve descripción del municipio 
)
;

COMMENT ON TABLE CAMUNICIPIO IS 'Tabla de municipios del censo'
;
COMMENT ON COLUMN CAMUNICIPIO.K_CODIGOPOSTAL   IS 'Codigo postal asignado por el DANE'
;
COMMENT ON COLUMN CAMUNICIPIO.N_MUNICIPIO      IS 'Nombre del municipio.'
;
COMMENT ON COLUMN CAMUNICIPIO.Q_NROHABITANTES  IS 'Es el número de Habitantes del Municipio.'
;
COMMENT ON COLUMN CAMUNICIPIO.I_ESCAPITAL      IS 'Indica si es capital del Departamento. S es Si y N es NO'
;
COMMENT ON COLUMN CAMUNICIPIO.O_DESCRIPCION    IS 'Breve descripción del municipio'
;

CREATE TABLE CAPERSONA
(
	K_IDENTIFICACION   varchar(12) NOT NULL,    --  Número de identificación de la persona 
	K_CEDCATVIVIENDA   numeric(18),    --  Cédula catastral de la vivienda. Es el número único asignado por Notaría y Registro 
	K_IDENRESPONSABLE  varchar(12) NOT NULL,    --  Número de identificación del responsable o cabeza de familia de la persona 
	N_APELLIDO         varchar(20) NOT NULL,    --  Apeliido de la persona 
	N_NOMBRE           varchar(50) NOT NULL,    --  Nombre de la persona 
	I_SEXO             varchar(1) NOT NULL,    --  Sexo (F,M) 
	I_ESTADOCIVIL      varchar(1),    --  Estado civil 
	F_NACIMIENTO       DATE NOT NULL    --  Fecha de nacimiento 
)
;

COMMENT ON TABLE CAPERSONA IS 'Tabla de Personas que habitan en una vivienda o son propietarias de una vivienda'
;
COMMENT ON COLUMN CAPERSONA.K_IDENTIFICACION   IS 'Número de identificación de la persona'
;
COMMENT ON COLUMN CAPERSONA.K_CEDCATVIVIENDA   IS 'Cédula catastral de la vivienda. Es el número único asignado por Notaría y Registro'
;
COMMENT ON COLUMN CAPERSONA.K_IDENRESPONSABLE  IS 'Número de identificación del responsable o cabeza de familia de la persona'
;
COMMENT ON COLUMN CAPERSONA.N_APELLIDO         IS 'Apeliido de la persona'
;
COMMENT ON COLUMN CAPERSONA.N_NOMBRE           IS 'Nombre de la persona'
;
COMMENT ON COLUMN CAPERSONA.I_SEXO             IS 'Sexo (F,M)'
;
COMMENT ON COLUMN CAPERSONA.I_ESTADOCIVIL      IS 'Estado civil'
;
COMMENT ON COLUMN CAPERSONA.F_NACIMIENTO       IS 'Fecha de nacimiento'
;

CREATE TABLE CAVIVIENDA
(
	K_CEDCATASTRAL     numeric(18) NOT NULL,    --  Cédula catastral definida por Notaria y registro 
	K_IDENPROPIETARIO  varchar(12) NOT NULL,    --  Identificación del Propietario
	C_NROESCRITURA     numeric(6) NOT NULL,    --  Número de la escritura asignado por la notaria. 
	C_NOTARIA          numeric(3) NOT NULL,    --  Número de la notaria 
	F_ESCRITURA        DATE,    --  Fecha de cuando se registra la vivienda 
	FK_CODIGOPOSTAL    numeric(8,2) NOT NULL    --  Codigo del municipio asociado a la vivienda
)
;

COMMENT ON TABLE CAVIVIENDA IS 'Entidad que contiene las viviendas de un Municipio'
;
COMMENT ON COLUMN CAVIVIENDA.K_CEDCATASTRAL     IS 'Cédula catastral definida por Notaria y registro'
;
COMMENT ON COLUMN CAVIVIENDA.K_IDENPROPIETARIO  IS 'Identificación del Propietario'
;
COMMENT ON COLUMN CAVIVIENDA.C_NROESCRITURA     IS 'Número de la escritura asignado por la notaria.'
;
COMMENT ON COLUMN CAVIVIENDA.C_NOTARIA          IS 'Número de la notaria'
;
COMMENT ON COLUMN CAVIVIENDA.F_ESCRITURA        IS 'Fecha de cuando se registra la vivienda'
;
COMMENT ON COLUMN CAVIVIENDA.FK_CODIGOPOSTAL    IS 'Codigo del municipio asociado a la vivienda'
;


--  Create Primary Key Constraints 
ALTER TABLE CAMUNICIPIO ADD CONSTRAINT PK_CAMUNICIPIO 
	PRIMARY KEY (K_CODIGOPOSTAL)
;

ALTER TABLE CAPERSONA ADD CONSTRAINT PK_CAPERSONA 
	PRIMARY KEY (K_IDENTIFICACION)
;

ALTER TABLE CAVIVIENDA ADD CONSTRAINT PK_CAVIVIENDA 
	PRIMARY KEY (K_CEDCATASTRAL) 
;



--  Create Foreign Key Constraints 
ALTER TABLE CAPERSONA ADD CONSTRAINT FK_CAPERSONA_CAPERSONA 
	FOREIGN KEY (K_IDENRESPONSABLE) REFERENCES CAPERSONA (K_IDENTIFICACION)
;

ALTER TABLE CAPERSONA ADD CONSTRAINT FK_CAPERSONA_CAVIVIENDA 
	FOREIGN KEY (K_CEDCATVIVIENDA) REFERENCES CAVIVIENDA (K_CEDCATASTRAL)
;

ALTER TABLE CAVIVIENDA ADD CONSTRAINT FK_CAVIVIENDA_CAPERSONA 
	FOREIGN KEY (K_IDENPROPIETARIO) REFERENCES CAPERSONA (K_IDENTIFICACION)
;

ALTER TABLE CAVIVIENDA ADD CONSTRAINT FK_VIVIENDA_MUNI 
	FOREIGN KEY (FK_CODIGOPOSTAL) REFERENCES CAMUNICIPIO (K_CODIGOPOSTAL)
;
